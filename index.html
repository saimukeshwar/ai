<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Free Video Call – Jitsi</title>
  <style>
    :root { --bg: #0b1220; --card:#111827; --text:#e5e7eb; --muted:#9ca3af; --accent:#22d3ee; }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans',sans-serif}
    body{margin:0;background:linear-gradient(180deg,#0b1220,#0f172a);color:var(--text);}
    .wrap{max-width:900px;margin:40px auto;padding:24px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35);overflow:hidden}
    header{padding:18px 22px;border-bottom:1px solid #1f2937;display:flex;align-items:center;gap:10px}
    header h1{font-size:18px;margin:0;font-weight:700}
    header .tag{margin-left:auto;font-size:12px;color:var(--muted)}
    .controls{display:flex;flex-wrap:wrap;gap:10px;padding:14px 16px;background:#0f172a;border-bottom:1px solid #1f2937}
    input,button,select{border-radius:10px;border:1px solid #243043;background:#0b1320;color:var(--text);padding:10px 12px}
    input::placeholder{color:#6b7280}
    button{cursor:pointer;background:linear-gradient(135deg,#06b6d4,#22d3ee);color:#06131a;border:none;font-weight:700}
    button.secondary{background:#0b1320;border:1px solid #293549;color:#c9d1d9}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:16px}
    .grid > div{background:#0b1320;border:1px solid #1e293b;border-radius:14px;padding:12px}
    .grid h3{margin:6px 0 10px 0;font-size:14px;color:#a5b4fc}
    #meet{height:70vh;width:100%;}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .small{font-size:12px;color:var(--muted)}
    a{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 7a3 3 0 0 1 3-3h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" stroke="#22d3ee" stroke-width="1.5"/><path d="M15 10.5l5-3v9l-5-3" stroke="#22d3ee" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <h1>Free Video Call (Jitsi Embed)</h1>
        <span class="tag">No backend • Works on meet.jit.si</span>
      </header>

      <div class="controls">
        <input id="room" placeholder="Room name (e.g., team-demo)" style="min-width:220px" />
        <input id="name" placeholder="Your display name" style="min-width:200px"/>
        <button id="start">Start / Join</button>
        <button class="secondary" id="leave">Leave</button>
        <button class="secondary" id="share">Copy Invite Link</button>
      </div>

      <div class="grid">
        <div>
          <h3>Meeting</h3>
          <div id="meet"></div>
        </div>
        <div>
          <h3>How to use</h3>
          <ol class="small">
            <li>Enter a <b>Room name</b> and your <b>Display name</b>, then click <b>Start / Join</b>.</li>
            <li>Share the invite link with others. Anyone opening the link joins the same room.</li>
            <li>Permissions: allow camera & mic in your browser.</li>
          </ol>
          <h3>Free Hosting (2 minutes)</h3>
          <ol class="small">
            <li>Save this file as <code>index.html</code>.</li>
            <li>Push to a GitHub repo, then: <b>Netlify</b> → "Import from Git" → select repo → deploy. Or use <b>Vercel</b> (Add New → Project → import repo → Deploy).</li>
            <li>Open your site URL (e.g., <code>https://yourname.netlify.app</code>) and start a call.</li>
          </ol>
          <p class="small">Jitsi provides TURN/STUN and media servers on <code>meet.jit.si</code> so this works without your own backend. For production, consider running your own Jitsi or using LiveKit/Agora/Twilio.</p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://meet.jit.si/external_api.js"></script>
  <script>
    let api;
    const d = (id)=>document.getElementById(id);

    function join() {
      const room = (d('room').value || '').trim();
      const name = (d('name').value || 'Guest').trim();
      if(!room){ alert('Enter a room name'); return; }

      // Destroy previous if any
      if (api) { try { api.dispose(); } catch(e){} }

      api = new JitsiMeetExternalAPI('meet.jit.si', {
        roomName: room,
        parentNode: d('meet'),
        userInfo: { displayName: name },
        configOverwrite: {
          disableDeepLinking: true
        },
        interfaceConfigOverwrite: {
          HIDE_INVITE_MORE_HEADER: true,
        },
        width: '100%',
        height: '100%'
      });
    }

    function leave(){ if(api){ api.dispose(); api = null; } }

    function copyLink(){
      const room = (d('room').value || '').trim();
      const base = window.location.origin + window.location.pathname;
      const url = `${base}?room=${encodeURIComponent(room)}`;
      navigator.clipboard.writeText(url).then(()=>{
        alert('Invite link copied!\n' + url);
      });
    }

    // Autoload from ?room=
    const params = new URLSearchParams(location.search);
    const preRoom = params.get('room');
    if(preRoom){ d('room').value = preRoom; }

    d('start').addEventListener('click', join);
    d('leave').addEventListener('click', leave);
    d('share').addEventListener('click', copyLink);
  </script>
</body>
</html>
